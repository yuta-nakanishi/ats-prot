# 採用管理システム (ATS: Applicant Tracking System)

## 概要
このプロジェクトは採用管理プロセスを効率化するためのマルチテナント型SaaSアプリケーションです。求人情報の管理、候補者のトラッキング、面接スケジュール、評価管理などの機能を提供します。複数企業（テナント）が共通のプラットフォーム上でサービスを利用できる設計になっています。

## 技術スタック

### フロントエンド
- Next.js (v14)
- TypeScript
- Tailwind CSS (スタイリング)
- React Hooks

### バックエンド
- NestJS (Node.jsフレームワーク)
- TypeORM (ORMツール)
- SQLite (データベース)
- JWT (認証)
- Swagger (API仕様書)

### プロジェクト管理
- Turborepo (モノレポ管理)

## システムアーキテクチャ

このシステムはマルチテナントアーキテクチャを採用しています。

- **単一インスタンス・マルチテナント方式**: 全てのテナントが同一のアプリケーションインスタンスを共有し、データベースレベルでテナント分離を実現
- **テナント識別子**: 各テナント（企業）はユニークなテナントIDを持ち、データアクセス時にフィルタリングに使用
- **ロールベースアクセス制御**: プラットフォーム管理者とテナント管理者の階層的な権限構造

## プロジェクト構造

```
ats-prot/
├── packages/
│   ├── backend/          # バックエンドアプリケーション (NestJS)
│   │   ├── src/
│   │   │   ├── auth/     # 認証関連
│   │   │   ├── companies/ # テナント（企業）管理
│   │   │   ├── candidates/ # 候補者管理
│   │   │   ├── job-postings/ # 求人情報管理
│   │   │   ├── interviews/ # 面接管理
│   │   │   ├── evaluations/ # 評価管理
│   │   │   ├── permissions/ # 権限管理
│   │   │   ├── app.module.ts # メインモジュール
│   │   │   ├── main.ts    # エントリーポイント
│   │   │   └── seed.ts    # シードデータ
│   │   └── package.json
│   └── frontend/         # フロントエンドアプリケーション (Next.js)
│       ├── src/
│       │   ├── app/       # App Router構造
│       │   │   ├── admin/  # プラットフォーム管理者向け機能
│       │   │   └── dashboard/  # テナント管理者・ユーザー向け機能
│       │   ├── components/ # UIコンポーネント
│       │   ├── lib/      # ユーティリティ関数、APIクライアント
│       │   └── types.ts  # 型定義
│       └── package.json
├── turbo.json           # Turborepo設定
└── package.json         # ルートパッケージ
```

## ユーザーロールと機能

### プラットフォーム管理者（スーパー管理者）
プラットフォーム全体を管理するロール。スーパー管理者は以下の機能にアクセスできます：

- **テナント管理**:
  - テナント一覧表示
  - テナント詳細表示
  - 新規テナント作成（テナント管理者の自動作成を含む）
  - テナント情報編集

### テナント管理者（企業管理者）
各テナント（企業）内のリソースを管理するロール。テナント管理者は以下の機能にアクセスできます：

- **ダッシュボード**: テナント固有の統計情報・概要
- **ユーザー管理**: テナント内のユーザー作成・編集・一覧表示
- **企業設定**: テナント情報の管理

### テナントユーザー
テナント内の一般ユーザー。割り当てられた役割に基づいて以下の機能にアクセスできます：

- **採用マネージャー**: 求人管理、候補者管理、全体レポート閲覧
- **リクルーター**: 候補者管理、面接スケジュール
- **面接官**: 面接参加、評価提出
- **閲覧専用**: 情報閲覧のみ（編集不可）

## セットアップと実行方法

### 前提条件
- Node.js (v18以上)
- npm (v9以上)

### インストール

```bash
# リポジトリのクローン
git clone https://github.com/yuta-nakanishi/ats-prot.git
cd ats-prot

# 依存関係のインストール
npm install
```

### 開発サーバーの起動

```bash
# フロントエンドとバックエンドを同時に起動
npm run dev

# バックエンドのみ起動
npm run dev --filter=@recruitment/backend

# フロントエンドのみ起動
npm run dev --filter=@recruitment/frontend
```

### 初期プラットフォーム管理者の作成

システムを初めて起動する場合、プラットフォーム管理者アカウントを作成する必要があります。

```bash
# バックエンドディレクトリに移動
cd packages/backend

# 以下のコマンドを実行してプラットフォーム管理者を作成
npm run create-super-admin -- --email=admin@example.com --password=yourpassword --name="管理者"
```

または、REST APIを直接呼び出してプラットフォーム管理者を作成することもできます：

```bash
curl -X POST http://localhost:3001/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@example.com",
    "password": "yourpassword",
    "name": "管理者",
    "isSuperAdmin": true
  }'
```

### システムへのログイン

1. フロントエンドサーバー（デフォルト: http://localhost:3000）にアクセス
2. ログインページで作成した管理者アカウントでログイン
3. ユーザーの役割に応じて適切なダッシュボードにリダイレクトされます
   - プラットフォーム管理者: `/admin` (テナント管理画面)
   - テナント管理者: `/dashboard/company/{テナントID}` (企業ダッシュボード)
   - 一般ユーザー: `/dashboard/company/{テナントID}` (企業ダッシュボード)

### テナントとユーザーの作成

1. プラットフォーム管理者としてログイン
2. テナント管理画面からテナントを新規作成
   - テナント作成時、そのテナントの管理者ユーザーが自動的に作成されます
3. テナント管理者がログインすることで、そのテナント内のユーザーを管理できます

## API仕様

バックエンドサーバー起動後、以下のURLでSwagger UIによるAPI仕様書にアクセスできます：
http://localhost:3001/api

## マルチテナント機能の拡張予定

今後実装予定の機能拡張：

1. **テナントカスタマイズ**
   - ブランド設定（ロゴ、カラーテーマ）
   - カスタムフィールド
   - ワークフローカスタマイズ

2. **支払いと請求管理**
   - サブスクリプションプラン
   - 請求書管理
   - 支払い履歴

3. **詳細な監査ログ**
   - ユーザー活動の記録
   - コンプライアンス用レポート

4. **高度なセキュリティ設定**
   - 2要素認証
   - IPアドレス制限
   - セッション管理

## ライセンス

MIT

## 連絡先

質問や問題がある場合は、GitHub Issuesを通じてご連絡ください。